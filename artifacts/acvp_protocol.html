<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Automated Cryptographic Validation Protocol </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Language"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Overview"/>
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Audience"/>
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Goals"/>
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Terminology"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Architecture"/>
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Server/Client Architecture"/>
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Server/Proxy Architecture"/>
<link href="#rfc.section.4" rel="Chapter" title="4 ACV Protocol"/>
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 HTTP URI Hierarchy"/>
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 HTTP URI Operations"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Security"/>
<link href="#rfc.section.6" rel="Chapter" title="6 Authentication"/>
<link href="#rfc.section.7" rel="Chapter" title="7 Traceability"/>
<link href="#rfc.section.8" rel="Chapter" title="8 Encoding"/>
<link href="#rfc.section.9" rel="Chapter" title="9 Versioning"/>
<link href="#rfc.section.10" rel="Chapter" title="10 Messaging"/>
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 Product Registration/Capabilities Exchange"/>
<link href="#rfc.section.10.2" rel="Chapter" title="10.2 Test Exchange"/>
<link href="#rfc.section.11" rel="Chapter" title="11 Message Formats"/>
<link href="#rfc.section.11.1" rel="Chapter" title="11.1 Establish Connection HTTPS GET/200 OK"/>
<link href="#rfc.section.11.2" rel="Chapter" title="11.2 Product Registration with Capabilities"/>
<link href="#rfc.section.11.3" rel="Chapter" title="11.3 Vector Set Download Request"/>
<link href="#rfc.section.11.4" rel="Chapter" title="11.4 Submit Test Results"/>
<link href="#rfc.section.11.5" rel="Chapter" title="11.5 Validation Results Request"/>
<link href="#rfc.section.11.6" rel="Chapter" title="11.6 Optional Flows"/>
<link href="#rfc.section.12" rel="Chapter" title="12 Vector Set Expiration"/>
<link href="#rfc.section.12.1" rel="Chapter" title="12.1 Resending Test Responses"/>
<link href="#rfc.section.13" rel="Chapter" title="13 Error Codes"/>
<link href="#rfc.section.14" rel="Chapter" title="14 Custom Specification Objects"/>
<link href="#rfc.section.14.1" rel="Chapter" title="14.1 BitString"/>
<link href="#rfc.section.14.1.1" rel="Chapter" title="14.1.1 Endianness"/>
<link href="#rfc.section.14.1.2" rel="Chapter" title="14.1.2 Hex to Bitstring Parsing"/>
<link href="#rfc.section.14.1.2.1" rel="Chapter" title="14.1.2.1 Hex string parsing examples"/>
<link href="#rfc.section.14.2" rel="Chapter" title="14.2 Range"/>
<link href="#rfc.section.14.2.1" rel="Chapter" title="14.2.1 Range JSON examples"/>
<link href="#rfc.section.14.3" rel="Chapter" title="14.3 Domain"/>
<link href="#rfc.section.14.3.1" rel="Chapter" title="14.3.1 Domain JSON examples"/>
<link href="#rfc.section.14.3.2" rel="Chapter" title="14.3.2 Additional Domain Information"/>
<link href="#rfc.section.15" rel="Chapter" title="15 Other Considerations"/>
<link href="#rfc.section.16" rel="Chapter" title="16 Acknowledgements"/>
<link href="#rfc.section.17" rel="Chapter" title="17 IANA Considerations"/>
<link href="#rfc.references" rel="Chapter" title="18 Normative References"/>
<link href="#rfc.appendix.A" rel="Chapter" title="A JSON Formatting Guidelines"/>
<link href="#rfc.appendix.B" rel="Chapter" title="B JSON Encoded Error Messages"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.4.3 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Fussell, B., Ed." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-acvp-protocol-0.4" />
  <meta name="dct.issued" scheme="ISO8601" content="2018-4-27" />
  <meta name="dct.abstract" content="This document defines the Automated Cryptographic Validation Protocol(ACVP)." />
  <meta name="description" content="This document defines the Automated Cryptographic Validation Protocol(ACVP)." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">Internet Engineering Task Force</td>
  <td class="right">B. Fussell, Ed.</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">Cisco Systems</td>
</tr>
<tr>
  <td class="left">Intended status: Informational</td>
  <td class="right">April 27, 2018</td>
</tr>
<tr>
  <td class="left">Expires: October 29, 2018</td>
  <td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Automated Cryptographic Validation Protocol <br />
  <span class="filename">draft-ietf-acvp-protocol-0.4</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This document defines the Automated Cryptographic Validation Protocol(ACVP).</p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on October 29, 2018.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2018 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<li>1.1.   <a href="#rfc.section.1.1">Requirements Language</a></li>
<li>2.   <a href="#rfc.section.2">Overview</a></li>
<li>2.1.   <a href="#rfc.section.2.1">Audience</a></li>
<li>2.2.   <a href="#rfc.section.2.2">Goals</a></li>
<li>2.3.   <a href="#rfc.section.2.3">Terminology</a></li>
<li>3.   <a href="#rfc.section.3">Architecture</a></li>
<li>3.1.   <a href="#rfc.section.3.1">Server/Client Architecture</a></li>
<li>3.2.   <a href="#rfc.section.3.2">Server/Proxy Architecture</a></li>
<li>4.   <a href="#rfc.section.4">ACV Protocol</a></li>
<li>4.1.   <a href="#rfc.section.4.1">HTTP URI Hierarchy</a></li>
<li>4.2.   <a href="#rfc.section.4.2">HTTP URI Operations</a></li>
<li>5.   <a href="#rfc.section.5">Security</a></li>
<li>6.   <a href="#rfc.section.6">Authentication</a></li>
<li>7.   <a href="#rfc.section.7">Traceability</a></li>
<li>8.   <a href="#rfc.section.8">Encoding</a></li>
<li>9.   <a href="#rfc.section.9">Versioning</a></li>
<li>10.   <a href="#rfc.section.10">Messaging</a></li>
<li>10.1.   <a href="#rfc.section.10.1">Product Registration/Capabilities Exchange</a></li>
<li>10.2.   <a href="#rfc.section.10.2">Test Exchange</a></li>
<li>11.   <a href="#rfc.section.11">Message Formats</a></li>
<li>11.1.   <a href="#rfc.section.11.1">Establish Connection HTTPS GET/200 OK</a></li>
<li>11.2.   <a href="#rfc.section.11.2">Product Registration with Capabilities</a></li>
<li>11.3.   <a href="#rfc.section.11.3">Vector Set Download Request</a></li>
<li>11.4.   <a href="#rfc.section.11.4">Submit Test Results</a></li>
<li>11.5.   <a href="#rfc.section.11.5">Validation Results Request</a></li>
<li>11.6.   <a href="#rfc.section.11.6">Optional Flows</a></li>
<li>12.   <a href="#rfc.section.12">Vector Set Expiration</a></li>
<li>12.1.   <a href="#rfc.section.12.1">Resending Test Responses</a></li>
<li>13.   <a href="#rfc.section.13">Error Codes</a></li>
<li>14.   <a href="#rfc.section.14">Custom Specification Objects</a></li>
<li>14.1.   <a href="#rfc.section.14.1">BitString</a></li>
<li>14.1.1.   <a href="#rfc.section.14.1.1">Endianness</a></li>
<li>14.1.2.   <a href="#rfc.section.14.1.2">Hex to Bitstring Parsing</a></li>
<li>14.1.2.1.   <a href="#rfc.section.14.1.2.1">Hex string parsing examples</a></li>
<li>14.2.   <a href="#rfc.section.14.2">Range</a></li>
<li>14.2.1.   <a href="#rfc.section.14.2.1">Range JSON examples</a></li>
<li>14.3.   <a href="#rfc.section.14.3">Domain</a></li>
<li>14.3.1.   <a href="#rfc.section.14.3.1">Domain JSON examples</a></li>
<li>14.3.2.   <a href="#rfc.section.14.3.2">Additional Domain Information</a></li>
<li>15.   <a href="#rfc.section.15">Other Considerations</a></li>
<li>16.   <a href="#rfc.section.16">Acknowledgements</a></li>
<li>17.   <a href="#rfc.section.17">IANA Considerations</a></li>
<li>18.   <a href="#rfc.references">Normative References</a></li>
<li>Appendix A.   <a href="#rfc.appendix.A">JSON Formatting Guidelines</a></li>
<li>Appendix B.   <a href="#rfc.appendix.B">JSON Encoded Error Messages</a></li>
<li><a href="#rfc.authors">Author's Address</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">ACVP enables communication between a cryptographic module that is embedded inside of a device or otherwise running on a platform accessible via computer network, and an external testing system, using standard network communication interfaces and protocols.  This communication protocol can also be used to validate the correctness of the implementations of the algorithms in the cryptographic module with a validation authority.  This document describes how ACVP is structured with respect to the client-server model, the messaging protocol, optional features and flows.</p>
<h1 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a> Requirements Language</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.</p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#caps_reg" id="caps_reg">Overview</a></h1>
<p id="rfc.section.2.p.1">ACVP has the following goals:</p>
<p/>

<ul>
  <li>To work in situations where the testing system is remote from the cryptographic module, e.g. running as a process on a separate device.</li>
  <li>To enable automated testing that can take place with a minimum of human interaction.</li>
  <li>To enable the testing system to discover the capabilities of the module being tested; that is, the particular algorithms and parameters that the module supports.</li>
  <li>To provide extensibility that can be used to introduce tests for new algorithms, and new tests for existing algorithms.</li>
  <li>To be compatible with emerging automated validation systems wherever possible, especially the FIPS-140 Cryptographic Algorithm Validation Program.</li>
  <li>To provide a standard communication method so that vendors can utilize the same testing service for FIPS-140, 3rd party crypto verification and product FCS readiness testing.</li>
</ul>
<p id="rfc.section.2.p.3">ACVP defines how to communicate a request (to execute a cryptographic operation) to a cryptographic module, and how to communicate the corresponding response (containing the output of that operation) back to a testing system.  It defines a transport (based on HTTP or HTTPS), an encoding and message format (which is negotiated), and a set of message exchanges.  Each vector test set corresponds to a single message exchange driven from the client associated with the module under test.  ACVP does not define the cryptographic algorithms, nor does it detail the precise conditions for a response to be acceptable.  Instead, it references existing specifications for those algorithms, and defines a mapping between the data on the wire and the algorithm testing specification.  ACVP does not define detailed conformance criteria, such as those in FIPS-140.  Instead, it aims to be independent of particular conformance criteria, so that it can be used in multiple domains with different (even potentially conflicting) conformance criteria.  ACVP does not define an interface that can be used to manage or control a cryptographic module.</p>
<h1 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a> Audience</h1>
<p id="rfc.section.2.1.p.1">This document is written to address multiple audiences:</p>
<p/>

<ul>
  <li>Crypto module developers who require validation testing</li>
  <li>Crypto validation organizations who will perform validation testing</li>
  <li>Crypto module customers that desire validation testing results or verifiable artifacts of testing</li>
</ul>
<h1 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2.</a> Goals</h1>
<p id="rfc.section.2.2.p.1">The goals for this document are to provide a messaging protocol that can be used with existing authentication and communication protocols to provide a way to test crypto modules.  The following functions are outside the scope of this document:</p>
<p/>

<ul>
  <li>The API to the cryptographic module</li>
  <li>How the tests are generated</li>
  <li>How the results/artifacts are stored or managed</li>
  <li>Authentication used</li>
  <li>Scalability</li>
  <li>Management interface</li>
</ul>
<p id="rfc.section.2.2.p.3">With that in mind there are several expectations when building a server used as a validation authority.  A validation authority shall use HTTPS, TLS 1.2 or greater and mutual authentication. Therefore a client that expects to be used with a validation authority shall have the same requirements.  A server, proxy or client developed for the purposes of internal organizational testing only may chose not to include some of those features.</p>
<h1 id="rfc.section.2.3"><a href="#rfc.section.2.3">2.3.</a> Terminology</h1>
<p id="rfc.section.2.3.p.1">TBD </p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> Architecture</h1>
<div id="rfc.figure.1"/>
<div id="xml_figure1"/>
<p>Server/Client Architecture</p>
<pre>

                           +----------------------------------------+
                           |                    +-----------------+ |
+----------+               | Entropy ----------&gt;| DRBG----Encrypt | |
| ACV      |               |                    |         Auth    | |
| Server   |&lt;=============&gt;| +--------+         |                 | |
+----------+               | | ACV    |&lt;-------&gt;| PKI-----Key Est | |
                           | | Client |    ^    |         Sign    | |
                           | +--------+    |    |                 | |
                           |            Crypto  | Crypto Module   | |
                           |            Module  +-----------------+ |
                           |              API                       |
                           |                                        |
                           |        Device Under Test (DUT)         |
                           +----------------------------------------+


           </pre>
<p class="figure">Figure 1</p>
<h1 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a> Server/Client Architecture</h1>
<p id="rfc.section.3.1.p.1">A server client model is used where the roles are defined as:</p>
<p/>

<ul>
  <li>ACV Client - resides in, or accessible from, the device under test and communicates with the ACV server using Java Script Object Notation (JSON) as well as the crypto module using product specific methods.</li>
  <li>ACV Server - Sends JSON formatted messaging and test data to the ACV client and processes test responses.</li>
  <li>ACV Proxy - Resides between the ACV server and ACV client to proxy the connection for the client.  This is particularly useful when the client does not support TLS, key management or have signature capabilities and they are required by the server.  An example architecture is provided in Figure 2.</li>
  <li>Device Under Test - contains the ACV client and the crypto module under test which can include various algorithms and functions that encrypt/decrypt, generate keys, signatures, perform varifications and DRBG functions.</li>
  <li>Crpyographic Module API - This is the interface to the crypto module from the ACV Client.  This interface is environment specific and will vary depending on the API available on the crypto module.</li>
</ul>
<h1 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a> Server/Proxy Architecture</h1>
<div id="rfc.figure.2"/>
<div id="xml_figure2"/>
<p>Server/Proxy Architecture</p>
<pre>


                +-----------------------------------------------------+                           
                |                         +-------------------------+ |
+----------+    |     +----------+        |                         | |
| ACV      |    |     | ACV      |        |                         | |
| Server   |&lt;========&gt;| Proxy    |&lt;======&gt;| +--------+   +--------+ | |
+----------+    |     +----------+        | | ACV    |&lt;-&gt;| Crypto | | |
                |                         | | Client |   | Module | | |
                |                         | +--------+   +--------+ | |
                |                         |                         | |
                |                         |      DUT                | |
                |                         +-------------------------+ |
                | Vendor/Customer Premise                             |
                +-----------------------------------------------------+

           </pre>
<p class="figure">Figure 2</p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> ACV Protocol</h1>
<p id="rfc.section.4.p.1">The ACV protocol will utilize existing mechanisms for transport coordinated with JSON formatted messaging.</p>
<div id="rfc.figure.3"/>
<div id="xml_figure3"/>
<p>Protocol Layering</p>
<pre>
+-----------------------------------------------+
| JSON Formatted ACVP request/response messages |
+-----------------------------------------------+
| HTTP[S] message transfer and signaling        |
+-----------------------------------------------+
| TLS for transport security(recommended)       |
+-----------------------------------------------+
| TCP for transport                             |
|_______________________________________________|

           </pre>
<p class="figure">Figure 3</p>
<h1 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a> HTTP URI Hierarchy</h1>
<div id="rfc.figure.4"/>
<div id="xml_figure4"/>
<pre>

          +-------------------------------------------------+
          server path prefix
          +-------------+----+------------------------------+
  https://acvts.nist.gov/acvp/validation/acvp/register
          +-------------+----+------------------------------+ 
                        context         operation

           </pre>
<p class="figure">Figure 4</p>
<p id="rfc.section.4.1.p.1">Note that deployments utilizing ACV Proxy server may use a different protocol, e.g., HTTP, and custom URI path prefix, context and port number to interact with the DUT.</p>
<h1 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a> HTTP URI Operations</h1>
<p id="rfc.section.4.2.p.1">Operations and their corresponding operation names</p>
<div id="rfc.table.1"/>
<div id="uri_table"/>
<table cellpadding="3" cellspacing="0" class="tt full center">
  <thead>
    <tr>
      <th class="left">Operation</th>
      <th class="left">Operation Path</th>
      <th class="left">HTTP Method</th>
      <th class="left">Details</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">Registration and DUT Capabilities</td>
      <td class="left">/register</td>
      <td class="left">POST</td>
      <td class="left">
        <a href="#reg_capex">Section 11.2</a>
      </td>
    </tr>
    <tr>
      <td class="left"/>
      <td class="left"/>
      <td class="left"/>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">Vector Set download request</td>
      <td class="left">/vectors</td>
      <td class="left">GET</td>
      <td class="left">
        <a href="#vector_dl">Section 11.3</a>
      </td>
    </tr>
    <tr>
      <td class="left"/>
      <td class="left"/>
      <td class="left"/>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">Submit Vector Test Results</td>
      <td class="left">/vectors</td>
      <td class="left">POST</td>
      <td class="left">
        <a href="#vector_dl2">Section 11.4</a>
      </td>
    </tr>
    <tr>
      <td class="left"/>
      <td class="left"/>
      <td class="left"/>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">Request Validation Results</td>
      <td class="left">/results</td>
      <td class="left">GET</td>
      <td class="left">
        <a href="#results_req">Section 11.5</a>
      </td>
    </tr>
    <tr>
      <td class="left"/>
      <td class="left"/>
      <td class="left"/>
      <td class="left"/>
    </tr>
    <tr>
      <td class="left">Request server to cancel session</td>
      <td class="left">/cancel</td>
      <td class="left">POST</td>
      <td class="left">
        <a href="#optional_flows">Section 11.6</a>
      </td>
    </tr>
  </tbody>
</table>
<p id="rfc.section.4.2.p.2">The operation path is appended to the path prefix to form the URI used with HTTP GET or POST to perform the desired ACVP operation.  An example valid URI absolute path for the "/register" operation is "/validation/acvp/register".  To register a DUT the ACVP client would use the following HTTP request-line:</p>
<p id="rfc.section.4.2.p.3">POST /validation/acvp/register HTTP/1.0</p>
<p id="rfc.section.4.2.p.4">Likewise, to request a specific vector set from the server the ACVP client would use the following request-line:</p>
<p id="rfc.section.4.2.p.5">GET /validation/acvp/vectors?vsId=1 HTTP/1.0</p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> Security</h1>
<p id="rfc.section.5.p.1">It is recommended that HTTPS and TLS 1.2 or greater be used in order to enforce a secure communication method.  Not all environments will have TLS so HTTP with some level of authentication may be the only option.</p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> Authentication</h1>
<p id="rfc.section.6.p.1">It is recommended that an authentication scheme be used.  Depending on the target environment and usage objectives, that can be as weak as basic HTTP authentication or as strong as TLS mutual certificate authentication. Definition of an authentication scheme will not be discussed here, but should be agreed upon between the client and server owning entities including the servers owned by the validation authorities.  For the purposes of the message flow examples, no authentication will be used.</p>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> Traceability</h1>
<p id="rfc.section.7.p.1">TBD </p>
<h1 id="rfc.section.8"><a href="#rfc.section.8">8.</a> Encoding</h1>
<p id="rfc.section.8.p.1">The encoding used for the request/response messaging will be JSON. The data will be identified by: Content-type: application/json In order to allow environment specific extensions to a particular version of the ACV protocol, a top-level JSON keyword, extensions will be used to extend the OE description and/or the capabilities.  Extensions may be ignored by the ACV server.  Vector and vector response data will be JSON encoded.</p>
<h1 id="rfc.section.9"><a href="#rfc.section.9">9.</a> Versioning</h1>
<p id="rfc.section.9.p.1">The version of the ACVP protocol will be carried with each message and will contain a simple major.minor format.  Major version changes will not be backward compatible, however additions and enhancements that do not disrupt compatibility will be indicated with a minor version change.  A server may accept a down-level version from the client if it can process at a lower level.  If not, it will reject the session.  All subsequent messages will carry the negotiated version value.</p>
<h1 id="rfc.section.10"><a href="#rfc.section.10">10.</a> Messaging</h1>
<h1 id="rfc.section.10.1"><a href="#rfc.section.10.1">10.1.</a> Product Registration/Capabilities Exchange</h1>
<p id="rfc.section.10.1.p.1">The product registration message will include many of the normal cryptographic algorithm identification line items that are found when filling out a testing form. This pre-test message will carry the Company name, primary contact (OE information) as well as a detailed list of the supported cryptographic algorithms to be tested during a session.  The server will return the vector test list to the client.  It will consist of a list of vector set IDs (vsId) each of which represent a set of test vectors which can be used to request the test vectors at a later time.</p>
<h1 id="rfc.section.10.2"><a href="#rfc.section.10.2">10.2.</a> Test Exchange</h1>
<p id="rfc.section.10.2.p.1">The test exchange consists of the ACV client requesting a particular set of vectors selected from the vector test list.  The server responds with the test vectors.  Once the client has run the vectors the response data will be returned to the server for processing.  The client will repeat this process until all of the tests in the session test list have been processed.  The client may request results from the server at any time, however if test sets have not been completed the overall status will be incomplete.</p>
<h1 id="rfc.section.11"><a href="#rfc.section.11">11.</a> Message Formats</h1>
<p id="rfc.section.11.p.1">Servers may require a contextual path in the URI prior to the service section and clients/proxies must be able to support it.</p>
<p id="rfc.section.11.p.2">Unique variable definitions to identify the vector set, device and session include:</p>
<p/>

<ul>
  <li>Session - represented by a JSON Web Token(JWT).  Within the JWT, the JWT ID(JTI) will be a unique identifier that will be generated by the server and can be used as a session ID.</li>
  <li>Vector Set - represented by the VS-ID which represents a specific CAVS vector request file, e.g. gcmEncryptIntIV128.req. Passed to the client as part of the capabilities exchange.</li>
</ul>
<p id="rfc.section.11.p.4">JWT example:</p>
<div id="rfc.figure.5"/>
<div id="xml_json1"/>
<pre>
{
"alg" : "none"
}
   {
      "iss" : "nist.gov",
      "exp" : 1426420800,
      "company" : "MyCompany",
      "jti" : 0987654321,
      "pkey" : "cc74f56acdba635079383a03941d68db55c7b3c2fcd0f9716c9b62d56d3f8f546e9ec0244203b6ab4a82c08a46b1dbc243c6434861e31ab51065f41dbce00482498d4474d1ed3b09dc727af6b9c788fdb5da283c5a98cf8ac9e473f34644c6bbfc146e28f8158f725ce25bcb73e0a2c05378739d101df15a0c1297a1a2e3abc7912e24caba5465e78f694ad0d3cf48f2f01c4580d774d592684756efbdf0cc7648470dd78a3b38973b18946e71c8feaf2f28b93a2ff36b1cc31236e5845145899e8a0438aeb1073bc0d23d5c7898845d5227867a38234739595d55a44e41a39feff8eb447757fc6b246d92f02fe43b46e46c7403a5966f40ba4e01ca64e955c5"
   }
   {
   Empty octet string (since alg is none).
   }
           </pre>
<p class="figure">Figure 5</p>
<p id="rfc.section.11.p.5">The JWT can be secured if desired using the header encryption "alg" value defined to HS256(HMAC-SHA256) or one of the other secure values.  Key agreement would follow RFC7518.  </p>
<p id="rfc.section.11.p.6">The first four claims are required, however "pkey" is an optional private claim used to pass the key used for encrypting the database at the server.  Enabling this option is discussed further in <a href="#reg_capex">Section 11.2</a></p>
<h1 id="rfc.section.11.1"><a href="#rfc.section.11.1">11.1.</a> Establish Connection HTTPS GET/200 OK</h1>
<p id="rfc.section.11.1.p.1">Establish the connection, send POST and receive 200 OK response with JWT from server.</p>
<div id="rfc.figure.6"/>
<div id="xml_json2"/>
<pre>
POST /validation/acvp/register HTTP1.0
Host: www.acvts.nist.gov/acvp
Capabilities information(see next section)

..authentication happens here..

HTTP 1.0 200 OK
Status: 200 OK
Content-Type: application/json
Content-Length: (length of JWT)
{
"accessToken" : 
"eyJhbGciOiJIUzI1NiIsI.eyJpc3MiOiJodHRwczotcGxlL.mFrs3Zo8eaSNcxiNfvRh9dqKP4F1cB",
}

Once the session is established the client must include the JWT with 
each message.

           </pre>
<p class="figure">Figure 6</p>
<p id="rfc.section.11.1.p.2">The authentication mechanism will be defined by the server.</p>
<h1 id="rfc.section.11.2"><a href="#rfc.section.11.2">11.2.</a> <a href="#reg_capex" id="reg_capex">Product Registration with Capabilities</a></h1>
<p id="rfc.section.11.2.p.1">POST the registration to the server consisting of the ACVP version, Operating Environment (OE), vector encoding, capabilities and any extensions. In addition there are a few parameters that specify session specific information:</p>
<p/>

<ul>
  <li>certificateRequest - If an algorithm certificate is not desired for this registration populate the field "certificateRequest"  with "no", otherwise "yes".</li>
  <li>debugRequest - If this vector session is for the purposes of testing the client or DUT prior to a certificate request and desires the answers to the vectors as well, indicate with "yes", otherwise omit the keyword or indicate with "no"</li>
  <li>production - If this is a production environment indicate so with "yes", otherwise omit this keyword or indicate with "no".  A production environment may not be able to support intermediate value tests and therefore those tests will be excluded.</li>
  <li>encryptAtRest - The client may request the server to encrypt all data at rest by registering "encryptAtRest" with "yes". Omitting the "encryptAtRest" field or registering with "no" will indicate to the server that no encryption is require for the data at rest.</li>
</ul>
<p id="rfc.section.11.2.p.3">Note that when a certificate request is made, production and debugRequest shall be omitted or set to "no". Conversely if no certificate is requested, the operationalEnvironment section may be omitted.</p>
<div id="rfc.figure.7"/>
<div id="xml_json3"/>
<pre>
POST /validation/acvp/register HTTP1.0
User Agent:
Host: www.acvts.nist.gov/acvp
Accept: 
[
 { "acvVersion": "0.4" },
 { "operation" : "register",
   "certificateRequest" : "yes",
   "debugRequest" : "no",
   "production" : "no",
   "encryptAtRest" : "yes",
   "oeInformation" : {
     "vendor": {
        "name" : "Cisco",
        "website": "www.cisco.com",
        "contact": [{
            "name" : "John Doe",
            "email" : "johndoe@cisco.com"
        }]
    },
    "module": {
      "name": "Cisco ACV Test Module",
      "version": "1.0",
      "type": "Software"
    },
    "operationalEnvironment" : {
        "dependencies" : [{
            "type" : "software",
            "name" : "Linux 3.1",
            "cpe"  : "cpe-2.3:o:ubuntu:linux:3.1"
        },{
            "type" : "processor",
            "manufacturer" : "Intel",
            "family" : "ARK",
            "name" : "Xeon",
            "series" : "5100",
            "features" : [ "rdrand" ]
        }]
    },
    "implementationDescription" : "Sample crypto module for demonstrating ACV protocol."
  },
  "capabilityExchange" : {
  "algorithms" : [
         {
  "algorithm" : "AES-GCM",
  "prereqVals" : [{"algorithm" : "AES", "valValue" : "123456"},
                {"algorithm" : "DRBG", "valValue" : "123456"}],
  "direction": [
    "encrypt",
    "decrypt"
  ],
  "ivGen" : "internal",
  "ivGenMode" : "8.2.1",
  "keyLen" : [
            128,
            256
             ],
  "tagLen" : [
            96
               ],
  "ivLen" : [
             96
               ],
  "dataLength" : [
             0,
             128,
             136
               ],
  "aadLen" : [
             128,
             136
               ]
         }
      ]
    }
  }
]
           </pre>
<p class="figure">Figure 7</p>
<p id="rfc.section.11.2.p.4">Successful response from server is 200 OK and a set of vector set identifiers.  The extensions section is optional and can be implementation specific for value add. Follow on versions could include protocol information.</p>
<div id="rfc.figure.8"/>
<div id="xml_json4"/>
<pre>
200 OK Response:
[
  { "acvVersion": "0.4" },
  { "capabilityResponse" : { "vectorSets" : [
                       {"vsId":1437},
                       {"vsId":1438}] } , 
    "testSession" :       {"testId":458} , 
    "accessToken" : "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiAibmlzdC5vcmciLCJleHAiOiAxNDYyOTg0OTUzLCJjb21wYW55IjogIkNpc2NvIiwianRpIjo0NTh9.zDhd3WrLcb1Xf5-VKOX6k-G70mACbi1tdir8qHAMPyQ" 
  }
]
           </pre>
<p class="figure">Figure 8</p>
<h1 id="rfc.section.11.3"><a href="#rfc.section.11.3">11.3.</a> <a href="#vector_dl" id="vector_dl">Vector Set Download Request</a></h1>
<p id="rfc.section.11.3.p.1">After registration, the server provides a list of vector sets to the client, each identified by a VS-ID.  The client shall download, process, and upload test results for each vector set, one at a time. Note that the client shall upload complete test results for each processed vector set, i.e. containing a result for every test case in the vector set.  </p>
<div id="rfc.figure.9"/>
<div id="xml_json5"/>
<pre>
GET /validation/acvp/vectors?vsId=1437  HTTP1.0
Host: www.acvts.nist.gov/acvp
Authorization: Bearer JWT
            </pre>
<p class="figure">Figure 9</p>
<p id="rfc.section.11.3.p.2">The server will respond with the vector set associated with the vsId for the client to process.  The actual test group content contained in the response will vary depending on the specific sub-specification of the algorithm and testType being tested.</p>
<div id="rfc.figure.10"/>
<div id="xml_json6"/>
<pre>

200 OK Response:
Status: 200 OK
Content-Type: application/json
Content-Length: &lt;length of results&gt;
[
 { "acvVersion": "0.4" },
 { "vsId": 1437,
   "algorithm": "AES-GCM",
   "testGroups": [
    {
      "direction": "encrypt",
      "keyLen": 128,
      "ivLen": 96,
      "ptLen": 0,
      "aadLen": 128,
      "tagLen": 128,
      "testType" : "AFT"
      "tests": [
        {
          "tcId": 12340,
          "key": "30BA1DBCB530347A148FB286D9A59757",
          "pt": "",
          "aad": "6CA553A59DFBD8F7E0DA619470F8986C"
        },
        {
          "tcId": 12341,
          "key": "AB7BB9349285B3E7403E99FED8B5060E",
          "pt": "",
          "aad": "79504FF995F70FFD328D7070CCBD62F1"
        }.....
]

	&lt;With debugRequest set iv, ct and tag would be included&gt;

            </pre>
<p class="figure">Figure 10</p>
<p id="rfc.section.11.3.p.3">If the server did not have enough time to generate the vector set for a given test session, the server may reply: </p>
<div id="rfc.figure.11"/>
<div id="xml_json7"/>
<pre>
HTTP 1.0 200 OK
Status: 200 OK
Content-Type: application/json
Content-Length: &lt;length of results&gt;
[
  { "acvVersion": "0.4" },
  { "vsId": 1437,
    "retry" : 10
  }
]
           </pre>
<p class="figure">Figure 11</p>
<p id="rfc.section.11.3.p.4">Where the retry value represents the number of seconds for the client to wait before retrying the request.  The server may set the retry value based on the current server load and expected processing time to generate the vector set.  </p>
<h1 id="rfc.section.11.4"><a href="#rfc.section.11.4">11.4.</a> <a href="#vector_dl2" id="vector_dl2">Submit Test Results</a></h1>
<p id="rfc.section.11.4.p.1">The client will send this request to submit the test results for an individual vector set. Similar to the vector set download the format will vary depending on the specific sub-specification of the algorithm and testType being tested.</p>
<div id="rfc.figure.12"/>
<div id="xml_json8"/>
<pre>
POST /validation/acvp/vectors?vsId=1437 HTTP1.0
Host: www.acvts.nist.gov/acvp
Authorization: Bearer JWT
Accept:   
[
 { "acvVersion": "0.4" },
 { "vsId": 1437,
   "testResults": [
   {
   "tcId": 12340,
   "iv": "01020304C077A707E56C22AC",
   "ct": "",
   "tag": "53B15E85E377F8B5B6BFC2DE915FD622"
   },
   {
   "tcId": 12341,
   "iv": "01020304D666587803BCBAD7",
   "ct": "",
   "tag": "E7B1F2D77D82C6EB3C9CEFF16C376D9C"
   }, ...
]
           </pre>
<p class="figure">Figure 12</p>
<h1 id="rfc.section.11.5"><a href="#rfc.section.11.5">11.5.</a> <a href="#results_req" id="results_req">Validation Results Request</a></h1>
<p id="rfc.section.11.5.p.1">The client will send this request to learn the validation results for an individual vector set.</p>
<div id="rfc.figure.13"/>
<div id="xml_json9"/>
<pre>
GET /validation/acvp/results?vsId=1437 HTTP1.0
User Agent:
Host: www.acvts.nist.gov/acvp
Accept: /


Response to GET is:

HTTP 1.0 200 OK
Status: 200 OK
Content-Type: application/json
Content-Length: &lt;length of results&gt;
[
  { "acvVersion": "0.4" },
  { "results" : {
      "vsId" : 1437,
      "disposition" : "incomplete",
      "tests" : [
            { "tcId" : 12340, "result" : "passed", "reason" : ""},
            { "tcId" : 12341, "result" : "incomplete", "reason" : ""},
            { "tcId" : 12342, "result" : "failed", "reason" : "Authentication tag mismatch"}
              ]
   }
]
           </pre>
<p class="figure">Figure 13</p>
<p id="rfc.section.11.5.p.2">The results request is an optional flow since some clients may not require success/fail information. Another possibility is to provide an out of band management session on the server may provide access to algorithm test results.</p>
<p id="rfc.section.11.5.p.3">"disposition" is defined overall for the entire vector set as:</p>
<p/>

<ul>
  <li>"fail" indicates at least one test case has failed.</li>
  <li>"unreceived" indicates the server has not received responses from the client for all the test cases.</li>
  <li>"incomplete" indicates not all tests have been processed by the server, however none have failed thus far.</li>
  <li>"expired" indicates not all the test case responses were received from the client prior to expiry.</li>
  <li>"passed" indicates all test cases have been processed by the server and have passed.</li>
</ul>
<p id="rfc.section.11.5.p.5">"result" is defined for individual test cases:</p>
<p/>

<ul>
  <li>"fail" indicates the test case has failed.</li>
  <li>"unreceived" indicates the server has not received a response from the client for the test case.</li>
  <li>"incomplete" indicates the server has not processed the test case.</li>
  <li>"expired" indicates the client did not send the test case response to the server prior to expiry.</li>
  <li>"passed" indicates the test case passed.</li>
  <li>"reason" provides additional detail for the test result.</li>
</ul>
<h1 id="rfc.section.11.6"><a href="#rfc.section.11.6">11.6.</a> <a href="#optional_flows" id="optional_flows">Optional Flows</a></h1>
<p id="rfc.section.11.6.p.1">The cancel URI can be used by the client to free a session.  The server is responsible for maintaining any database information for traceability or debugging purposes it desires.  This may be important for those cases where there are test failures.</p>
<div id="rfc.figure.14"/>
<div id="xml_json10"/>
<pre>
POST /validation/acvp/cancel HTTP1.0
Host: www.acvts.nist.gov/acvp
Authorization: Bearer JWT
           </pre>
<p class="figure">Figure 14</p>
<p id="rfc.section.11.6.p.2">The server response will always be 200 OK.</p>
<h1 id="rfc.section.12"><a href="#rfc.section.12">12.</a> Vector Set Expiration</h1>
<p id="rfc.section.12.p.1">Vector sets can expire.  For example, in terms of a validation authority use, the vector sets are one-time use only.  Old vector sets can never be reused to obtain a new validation certificate for an algorithm implementation or to update an existing certificate. Expiration is a server specific definition which depends on database costs, need for artifacts, etc. If the vector set has expired, the server will reply with an expired response when the client attempts to download the vector set: </p>
<div id="rfc.figure.15"/>
<div id="xml_json11"/>
<pre>
HTTP 1.0 200 OK
Status: 200 OK
Content-Type: application/json
Content-Length: &lt;length of results&gt;
[
  { "acvVersion": "0.4" },
  { "vsId" : &lt;vs-id&gt;,
    "status" : "expired"
  }
]
           </pre>
<p class="figure">Figure 15</p>
<p id="rfc.section.12.p.2">The ACVP protocol requires server implementations to generate test values and retain the data while the ACVP client processes and returns the results.  Some crypto modules implementing the client-side ACVP protocol may not return results immediately.  The ACVP protocol design implies the server must retain the test values to verify the client test responses at some time in the future.  However, some test vector sets are fairly large, which could place significant storage requirements on ACVP server implementations.  To alleviate long term storage requirements, ACVP allows for an expiration timestamp to be set when a test vector set is generated by the server.  </p>
<p id="rfc.section.12.p.3">The vector set expiration timestamp must be included by the server in the vector set when the client downloads the vector set.  The server may change the expiration timestamp of a previously issued vector set to extend its lifetime subject to server policy.  The expiration timestamp must be in the 'expiry' JSON value, which is included in the JSON encoded vector set.  The expiry JSON value will be a string value of the UTC timestamp using form "YYYY-MM-DD HH:MM:SS".  The following figure shows a partial JSON encoded vector set that contains the expiry value.  </p>
<div id="rfc.figure.16"/>
<div id="xml_json12"/>
<pre>
              [
                { "acvVersion": "0.4" },
                { "vsId": 1437,
		  "expiry": "2018-12-31 23:59:59",
                  "algorithm": "AES-GCM",
                  "testGroups": [
                    {
                      "direction": "encrypt",
                      "keyLen": 128,
                      "ivLen": 96,
                      "ptLen": 0,
                      "aadLen": 128,
                      "tagLen": 128,
                      "tests": [
                        {
                          "tcId": 12340,
                          "key": "1529BAC6229586F057FAA59353851686",
                          "pt": "",
                          "aad": "4B11160620475D8EE440C3795CF62D26"
                        },
			.
			.
			.
			&lt;remainder of vector set omitted from figure&gt;
			.
			.
			.
          ]

	    </pre>
<p class="figure">Figure 16</p>
<h1 id="rfc.section.12.1"><a href="#rfc.section.12.1">12.1.</a> Resending Test Responses</h1>
<p id="rfc.section.12.1.p.1">When one or more test cases fails, the client will need to correct the issue in the crypto module and send the responses again.  The resending of responses for failed test cases will occur for an entire vector set.  Therefore, even if only a single test case in the vector set failed, the client will need to download, process, and upload responses to the server for the entire vector set (presumably after the problem has been corrected in the DUT).  The resending of vector set responses must occur prior to expiry.  </p>
<h1 id="rfc.section.13"><a href="#rfc.section.13">13.</a> Error Codes</h1>
<p id="rfc.section.13.p.1">Errors will follow HTTP[S] numbering scheme.  In addition errors as well as 200 messages may carry JSON encoded information that describes in detail the error and any associated troubleshooting information.  A non-exhaustive list of JSON encoded error messages are in Appendix B.</p>
<h1 id="rfc.section.14"><a href="#rfc.section.14">14.</a> Custom Specification Objects</h1>
<h1 id="rfc.section.14.1"><a href="#rfc.section.14.1">14.1.</a> BitString</h1>
<p id="rfc.section.14.1.p.1">Bitstrings are used to communicate a string of bits between the ACVP server and IUT.  </p>
<h1 id="rfc.section.14.1.1"><a href="#rfc.section.14.1.1">14.1.1.</a> Endianness</h1>
<p id="rfc.section.14.1.1.p.1">BitStrings should be considered in big endian order, unless otherwise specified by the algorithm.  </p>
<p id="rfc.section.14.1.1.p.2">The hex string "FA" (assuming all bits are considered) should represent the bits 11111010 (in MSb) or the value 250.  </p>
<h1 id="rfc.section.14.1.2"><a href="#rfc.section.14.1.2">14.1.2.</a> Hex to Bitstring Parsing</h1>
<p id="rfc.section.14.1.2.p.1">"valueLen" will be used as the example, but it can apply to any bit length registration/vector set/etc parameters.  </p>
<p id="rfc.section.14.1.2.p.2">When a "value" is provided along with a "valueLen", the "valueLen" MUST be considered when parsing the hex string represented in "value", EXCEPT in empty bitstring cases, which MUST be represented as an empty string "".  Parsing Hex strings into Bit strings is especially important for algorithms such as the SHA variations that may only include a portion of bits from the provided hex string.  When only a portion of bits from a Hex string are considered, bits for use in the bitstring should be taken from the most significant bits, meaning the lesser significant bits are the bits that are dropped.  </p>
<h1 id="rfc.section.14.1.2.1"><a href="#rfc.section.14.1.2.1">14.1.2.1.</a> Hex string parsing examples</h1>
<p/>

<ul>
  <li>valueLen: 8, value: "FA", should be parsed as the bits 11111010, or the value 250.  </li>
  <li>valueLen: 7, value: "FA", should be parsed as the bits 1111101, or the value 125.  </li>
  <li>valueLen: 5, value: "FA", should be parsed as the bits 11111, or the value 31.  </li>
  <li>valueLen: 3, value: "FA", should be parsed as the bits 111, or the value 7.  </li>
  <li>valueLen: 0, value: "", MUST be interpreted as an empty bit string.  </li>
</ul>
<h1 id="rfc.section.14.2"><a href="#rfc.section.14.2">14.2.</a> Range</h1>
<p id="rfc.section.14.2.p.1">The Range object can be used to convey a range of values.  It contains its own set of properties made up of "min", "max", and "increment".  </p>
<h1 id="rfc.section.14.2.1"><a href="#rfc.section.14.2.1">14.2.1.</a> Range JSON examples</h1>
<p id="rfc.section.14.2.1.p.1">A range object specifying a minimum of 0, a maximum of 8, with an increment of 1.  This range object includes the values 1, 2, 3, 4, 5, 6, 7, and 8.  </p>
<div id="rfc.figure.17"/>
<div id="xml_json13"/>
<pre>
          
          {
            "myRange" : 
            {  
              "min" : 1,
              "max" : 8,
              "increment" : 1
            }
          }
          
        </pre>
<p class="figure">Figure 17</p>
<p id="rfc.section.14.2.1.p.2">A range object specifying a minimum of 0, a maximum of 8, with an increment of 2.  This range object includes the values 0, 2, 4, 6, and 8.  </p>
<div id="rfc.figure.18"/>
<div id="xml_json14"/>
<pre>
          
          {
            "myRange" : 
            {  
              "min" : 0,
              "max" : 8,
              "increment" : 2
            }
          }
          
        </pre>
<p class="figure">Figure 18</p>
<h1 id="rfc.section.14.3"><a href="#rfc.section.14.3">14.3.</a> Domain</h1>
<p id="rfc.section.14.3.p.1">The Domain object can be used to specify a set of values similar to Range, albeit with more control.  A domain can be made up of an array of objects, where those objects can be literal values, and/or Range objects.  </p>
<h1 id="rfc.section.14.3.1"><a href="#rfc.section.14.3.1">14.3.1.</a> Domain JSON examples</h1>
<p id="rfc.section.14.3.1.p.1">Several sample domain objects that state 0, 8, 16, 32, 96, 128, 192, and 256 are valid values.  </p>
<div id="rfc.figure.19"/>
<div id="xml_json15"/>
<pre>
          
          {
            "myDomain" : 
            [
              {  
                "min" : 0,
                "max" : 16,
                "increment" : 8
              },
              32,
              96,
              {  
                "min" : 128,
                "max" : 256,
                "increment" : 64
              }
            ]
          }
          
        </pre>
<p class="figure">Figure 19</p>
<div id="rfc.figure.20"/>
<div id="xml_json16"/>
<pre>
          
          {
            "myDomain" : 
            [
              0, 8, 16, 32, 96, 128, 192, 256
            ]
          }
          
        </pre>
<p class="figure">Figure 20</p>
<h1 id="rfc.section.14.3.2"><a href="#rfc.section.14.3.2">14.3.2.</a> Additional Domain Information</h1>
<p id="rfc.section.14.3.2.p.1">Because the Domain is an array of objects consisting of (potentially) both literals and ranges, algorithms that use an array of integers can be used interchangably with the Domain object.  </p>
<h1 id="rfc.section.15"><a href="#rfc.section.15">15.</a> Other Considerations</h1>
<p id="rfc.section.15.p.1">When an ACVP client is attached to a cryptographic module that is in use, access to ACVP MUST be controlled so that only an administrator or other authorized user can send and receive ACVP messages.  This is because an attacker that has access to ACVP can potentially use it to probe for weaknesses in the cryptographic module.</p>
<h1 id="rfc.section.16"><a href="#rfc.section.16">16.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a></h1>
<p id="rfc.section.16.p.1">Original ACVP created by David McGrew, Bill Hudson and Anthony Grieco of Cisco Systems.</p>
<h1 id="rfc.section.17"><a href="#rfc.section.17">17.</a> <a href="#IANA" id="IANA">IANA Considerations</a></h1>
<p id="rfc.section.17.p.1">This memo includes no request to IANA.</p>
<h1 id="rfc.references"><a href="#rfc.references">18.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.appendix.A"><a href="#rfc.appendix.A">Appendix A.</a> <a href="#app-reg-ex" id="app-reg-ex">JSON Formatting Guidelines</a></h1>
<p id="rfc.section.A.p.1">All JSON keywords shall use lower camelCase format with no underscores or hyphens and use the following characters only a-z, A-Z, 0-9. Keywords shall abbreviate common words and phrases wherever possible for brevity.</p>
<p id="rfc.section.A.p.2">For example: password length - pwLen plain text length - ptLen </p>
<p id="rfc.section.A.p.3">Keywords should be chosen such that they are informative and brief, for example: </p>
<p id="rfc.section.A.p.4">[ { "acvVersion": "0.4" }, { "results" : { "disposition" : "incomplete", } } ] </p>
<p id="rfc.section.A.p.5">Metadata assigned to the keyword may use any format which best reflects the information being represented including hyphens, underscores alternating case, numbers, etc. However, brevity should be a major consideration, for example:</p>
<p id="rfc.section.A.p.6">"algorithms" : [ { "algorithm" : "AES-GCM", "mode" : "modes", "ivGen" : "internal", "ivGenMode" : "8.2.1", } All metadata representing strings or big numbers shall use double quotes at both ends.  Big numbers require conversion from strings to whatever format is used by the DUT.  Numerical values of integer size or with decimal points may use quotations if those values are generally used as a string, for example the acvVersion would generally be used in displaying information not in any mathematical operations.  Something like keyLen or ptLen values would be better used without quotes to avoid having to convert the string to an integer for use in the code.  </p>
<h1 id="rfc.appendix.B"><a href="#rfc.appendix.B">Appendix B.</a> <a href="#app-reg-ex2" id="app-reg-ex2">JSON Encoded Error Messages</a></h1>
<p id="rfc.section.B.p.1">TBD </p>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Author's Address</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Barry Fussell</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Fussell</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span>170 West Tasman Dr.</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:bfussell@cisco.com">bfussell@cisco.com</a></span>

  </address>
</div>

</body>
</html>
